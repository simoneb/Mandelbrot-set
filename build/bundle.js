var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function r(t){return document.createElement(t)}function a(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function h(t){return document.createTextNode(t)}function f(){return h(" ")}function d(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t){return""===t?null:+t}function m(t,e){t.value=null==e?"":e}let g;function $(t){g=t}function w(){if(!g)throw new Error("Function called outside component initialization");return g}function y(){const t=w();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const i=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach((e=>{e.call(t,i)}))}}}const x=[],b=[],_=[],k=[],O=Promise.resolve();let C=!1;function L(t){_.push(t)}function M(t){k.push(t)}let j=!1;const z=new Set;function E(){if(!j){j=!0;do{for(let t=0;t<x.length;t+=1){const e=x[t];$(e),q(e.$$)}for($(null),x.length=0;b.length;)b.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];z.has(e)||(z.add(e),e())}_.length=0}while(x.length);for(;k.length;)k.pop()();C=!1,j=!1,z.clear()}}function q(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(L)}}const I=new Set;let T;function N(t,e){t&&t.i&&(I.delete(t),t.i(e))}function B(t,e,n,o){if(t&&t.o){if(I.has(t))return;I.add(t),T.c.push((()=>{I.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function D(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function A(t){t&&t.c()}function S(t,n,s){const{fragment:c,on_mount:l,on_destroy:u,after_update:r}=t.$$;c&&c.m(n,s),L((()=>{const n=l.map(e).filter(i);u?u.push(...n):o(n),t.$$.on_mount=[]})),r.forEach(L)}function W(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function V(t,e){-1===t.$$.dirty[0]&&(x.push(t),C||(C=!0,O.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,i,s,c,l,r,a=[-1]){const h=g;$(e);const f=i.props||{},d=e.$$={fragment:null,ctx:null,props:r,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:[]),callbacks:n(),dirty:a,skip_bound:!1};let p=!1;if(d.ctx=s?s(e,f,((t,n,...o)=>{const i=o.length?o[0]:n;return d.ctx&&l(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),p&&V(e,t)),n})):[],d.update(),p=!0,o(d.before_update),d.fragment=!!c&&c(d.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);d.fragment&&d.fragment.l(t),t.forEach(u)}else d.fragment&&d.fragment.c();i.intro&&N(e.$$.fragment),S(e,i.target,i.anchor),E()}$(h)}class Y{$destroy(){W(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}class H{constructor(){this.worker=new Worker("build/worker.js")}async sendWasm(){await this.command("loadWasm",await H.getWasm())}command(t,e){return new Promise(((n,o)=>{this.worker.onmessage=t=>n(t.data),this.worker.postMessage({action:t,data:e})}))}static async getWasm(){if(void 0===H.wasm){const t=await fetch("build/generate.wasm");H.wasm=await t.arrayBuffer()}return H.wasm}terminate(){this.worker.terminate()}static async changeNumberOfThreads(t){for(;H.all.length!=t;)if(H.all.length<t){const t=new H;await t.sendWasm(),H.all.push(t)}else H.all.pop().terminate()}}H.all=[];class P{constructor(t,e){this.x=t,this.y=e}copy(){return new P(this.x,this.y)}}function R(e){let n,o;return{c(){n=a("svg"),o=a("path"),p(o,"d","M12,18V6A6,6 0 0,1 18,12A6,6 0 0,1 12,18M20,15.31L23.31,12L20,8.69V4H15.31L12,0.69L8.69,4H4V8.69L0.69,12L4,15.31V20H8.69L12,23.31L15.31,20H20V15.31Z"),p(o,"fill",e[2]),p(n,"width",e[0]),p(n,"height",e[1]),p(n,"viewBox",e[3])},m(t,e){l(t,n,e),c(n,o)},p(t,[e]){4&e&&p(o,"fill",t[2]),1&e&&p(n,"width",t[0]),2&e&&p(n,"height",t[1]),8&e&&p(n,"viewBox",t[3])},i:t,o:t,d(t){t&&u(n)}}}function U(t,e,n){let{size:o="1em"}=e,{width:i=o}=e,{height:s=o}=e,{color:c="currentColor"}=e,{viewBox:l="0 0 24 24"}=e;return t.$$set=t=>{"size"in t&&n(4,o=t.size),"width"in t&&n(0,i=t.width),"height"in t&&n(1,s=t.height),"color"in t&&n(2,c=t.color),"viewBox"in t&&n(3,l=t.viewBox)},[i,s,c,l,o]}class F extends Y{constructor(t){super(),X(this,t,U,R,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function Z(e){let n,i,s,a,g,$,w,y,x,b,_,k,O,C,L,M,j,z,E,q,I,T,N,B,D,A,S,W,V,X,Y,H,P,R,U,F,Z,G,J,K,Q,tt,et,nt,ot,it;return{c(){n=r("form"),i=r("div"),s=r("h2"),s.textContent="Center position",a=h("\n        ("),g=r("input"),$=h(",\n        "),w=r("input"),y=h(")"),x=f(),b=r("div"),_=r("h2"),_.textContent="Zoom",k=f(),O=r("input"),C=h("%"),L=f(),M=r("div"),j=r("h2"),j.textContent="Canvas size",z=f(),E=r("input"),q=h("\n        Ã—\n        "),I=r("input"),T=f(),N=r("div"),B=r("h2"),B.textContent="Color",D=f(),A=r("label"),S=r("input"),W=h("\n            Color"),V=f(),X=r("label"),Y=r("input"),H=h("\n            Black & white"),P=f(),R=r("div"),U=r("h2"),U.textContent="Number of iterations",F=f(),Z=r("input"),G=f(),J=r("div"),K=r("h2"),K.textContent="Number of threads",Q=f(),tt=r("input"),et=f(),nt=r("input"),p(s,"class","svelte-pnhho6"),p(g,"type","number"),p(g,"step","any"),p(g,"class","svelte-pnhho6"),p(w,"type","number"),p(w,"step","any"),p(w,"class","svelte-pnhho6"),p(i,"class","svelte-pnhho6"),p(_,"class","svelte-pnhho6"),p(O,"type","number"),p(O,"step","0.1"),p(O,"class","svelte-pnhho6"),p(b,"class","svelte-pnhho6"),p(j,"class","svelte-pnhho6"),p(E,"type","number"),p(E,"class","svelte-pnhho6"),p(I,"type","number"),p(I,"class","svelte-pnhho6"),p(M,"class","svelte-pnhho6"),p(B,"class","svelte-pnhho6"),p(S,"type","radio"),S.__value="true",S.value=S.__value,p(S,"class","svelte-pnhho6"),e[15][0].push(S),p(A,"class","svelte-pnhho6"),p(Y,"type","radio"),Y.__value="false",Y.value=Y.__value,p(Y,"class","svelte-pnhho6"),e[15][0].push(Y),p(X,"class","svelte-pnhho6"),p(N,"class","color-container svelte-pnhho6"),p(U,"class","svelte-pnhho6"),p(Z,"type","number"),p(Z,"class","svelte-pnhho6"),p(R,"class","svelte-pnhho6"),p(K,"class","svelte-pnhho6"),p(tt,"type","number"),p(tt,"class","svelte-pnhho6"),p(J,"class","svelte-pnhho6"),p(nt,"type","submit"),nt.value="Update",p(nt,"class","svelte-pnhho6"),p(n,"class","svelte-pnhho6")},m(t,o){l(t,n,o),c(n,i),c(i,s),c(i,a),c(i,g),m(g,e[2].x),c(i,$),c(i,w),m(w,e[2].y),c(i,y),c(n,x),c(n,b),c(b,_),c(b,k),c(b,O),m(O,e[3]),c(b,C),c(n,L),c(n,M),c(M,j),c(M,z),c(M,E),m(E,e[0]),c(M,q),c(M,I),m(I,e[1]),c(n,T),c(n,N),c(N,B),c(N,D),c(N,A),c(A,S),S.checked=S.__value===e[6],c(A,W),c(N,V),c(N,X),c(X,Y),Y.checked=Y.__value===e[6],c(X,H),c(n,P),c(n,R),c(R,U),c(R,F),c(R,Z),m(Z,e[4]),c(n,G),c(n,J),c(J,K),c(J,Q),c(J,tt),m(tt,e[5]),c(n,et),c(n,nt),ot||(it=[d(g,"input",e[9]),d(w,"input",e[10]),d(O,"input",e[11]),d(E,"input",e[12]),d(I,"input",e[13]),d(S,"change",e[14]),d(Y,"change",e[16]),d(Z,"input",e[17]),d(tt,"input",e[18]),d(n,"submit",e[7])],ot=!0)},p(t,[e]){4&e&&v(g.value)!==t[2].x&&m(g,t[2].x),4&e&&v(w.value)!==t[2].y&&m(w,t[2].y),8&e&&v(O.value)!==t[3]&&m(O,t[3]),1&e&&v(E.value)!==t[0]&&m(E,t[0]),2&e&&v(I.value)!==t[1]&&m(I,t[1]),64&e&&(S.checked=S.__value===t[6]),64&e&&(Y.checked=Y.__value===t[6]),16&e&&v(Z.value)!==t[4]&&m(Z,t[4]),32&e&&v(tt.value)!==t[5]&&m(tt,t[5])},i:t,o:t,d(t){t&&u(n),e[15][0].splice(e[15][0].indexOf(S),1),e[15][0].splice(e[15][0].indexOf(Y),1),ot=!1,o(it)}}}function G(t,e,n){let o=y();let{width:i}=e,{height:s}=e,{offset:c}=e,{zoom:l}=e,{color:u}=e,{numberOfIterations:r}=e,{numberOfThreads:a}=e,h="true";return t.$$set=t=>{"width"in t&&n(0,i=t.width),"height"in t&&n(1,s=t.height),"offset"in t&&n(2,c=t.offset),"zoom"in t&&n(3,l=t.zoom),"color"in t&&n(8,u=t.color),"numberOfIterations"in t&&n(4,r=t.numberOfIterations),"numberOfThreads"in t&&n(5,a=t.numberOfThreads)},t.$$.update=()=>{64&t.$$.dirty&&n(8,u="true"===h)},[i,s,c,l,r,a,h,function(t){t.preventDefault(),o("update")},u,function(){c.x=v(this.value),n(2,c)},function(){c.y=v(this.value),n(2,c)},function(){l=v(this.value),n(3,l)},function(){i=v(this.value),n(0,i)},function(){s=v(this.value),n(1,s)},function(){h=this.__value,n(6,h)},[[]],function(){h=this.__value,n(6,h)},function(){r=v(this.value),n(4,r)},function(){a=v(this.value),n(5,a)}]}class J extends Y{constructor(t){super(),X(this,t,G,Z,s,{width:0,height:1,offset:2,zoom:3,color:8,numberOfIterations:4,numberOfThreads:5})}}function K(e){let n,o;return{c(){n=r("div"),p(n,"style",o="--color: "+(e[0]?"#333":"#ccc")),p(n,"class","svelte-ghrpqq")},m(t,e){l(t,n,e)},p(t,[e]){1&e&&o!==(o="--color: "+(t[0]?"#333":"#ccc"))&&p(n,"style",o)},i:t,o:t,d(t){t&&u(n)}}}function Q(t,e,n){let{lightMode:o=!1}=e;return t.$$set=t=>{"lightMode"in t&&n(0,o=t.lightMode)},[o]}class tt extends Y{constructor(t){super(),X(this,t,Q,K,s,{lightMode:0})}}function et(e){let n,o,i,s;return i=new tt({props:{lightMode:"true"===localStorage.lightMode}}),{c(){n=r("div"),o=r("div"),A(i.$$.fragment),p(o,"class","spinner-container svelte-1j72xq8"),p(n,"class","overlay svelte-1j72xq8")},m(t,e){l(t,n,e),c(n,o),S(i,o,null),s=!0},p:t,i(t){s||(N(i.$$.fragment,t),s=!0)},o(t){B(i.$$.fragment,t),s=!1},d(t){t&&u(n),W(i)}}}function nt(t){let e,n,i,s,a,v,g,$,w,y,x,_,k,O,C,L,j,z,E,q,I,V,X,Y,H,P,R;function U(e){t[26].call(null,e)}function Z(e){t[27].call(null,e)}function G(e){t[28].call(null,e)}function K(e){t[29].call(null,e)}function Q(e){t[30].call(null,e)}function tt(e){t[31].call(null,e)}function nt(e){t[32].call(null,e)}g=new F({});let it={};void 0!==t[2]&&(it.width=t[2]),void 0!==t[3]&&(it.height=t[3]),void 0!==t[4]&&(it.offset=t[4]),void 0!==t[1]&&(it.zoom=t[1]),void 0!==t[5]&&(it.color=t[5]),void 0!==t[7]&&(it.numberOfThreads=t[7]),void 0!==t[6]&&(it.numberOfIterations=t[6]),C=new J({props:it}),b.push((()=>D(C,"width",U))),b.push((()=>D(C,"height",Z))),b.push((()=>D(C,"offset",G))),b.push((()=>D(C,"zoom",K))),b.push((()=>D(C,"color",Q))),b.push((()=>D(C,"numberOfThreads",tt))),b.push((()=>D(C,"numberOfIterations",nt))),C.$on("update",t[20]);let st=t[9]&&et();return{c(){e=r("h1"),e.textContent="Mandelbrot set generator",n=f(),i=r("span"),s=h(t[0]),a=f(),v=r("div"),A(g.$$.fragment),$=f(),w=r("div"),y=r("div"),x=r("canvas"),_=f(),k=r("input"),O=f(),A(C.$$.fragment),X=f(),st&&st.c(),Y=h(""),p(e,"class","svelte-1j72xq8"),p(i,"class","version svelte-1j72xq8"),p(v,"class","icon-container svelte-1j72xq8"),p(x,"width",t[2]),p(x,"height",t[3]),p(x,"class","svelte-1j72xq8"),p(k,"type","range"),p(k,"min","-1"),p(k,"max","1"),p(k,"step","0.01"),p(k,"class","svelte-1j72xq8"),p(y,"class","container svelte-1j72xq8"),p(w,"class","main-container svelte-1j72xq8")},m(o,u){l(o,e,u),l(o,n,u),l(o,i,u),c(i,s),l(o,a,u),l(o,v,u),S(g,v,null),l(o,$,u),l(o,w,u),c(w,y),c(y,x),t[21](x),c(y,_),c(y,k),m(k,t[10]),c(w,O),S(C,w,null),l(o,X,u),st&&st.m(o,u),l(o,Y,u),H=!0,P||(R=[d(v,"click",ot),d(x,"mousedown",t[22]),d(x,"mousemove",t[23]),d(x,"mouseup",t[24]),d(x,"touchstart",t[17]),d(x,"touchmove",t[18]),d(x,"touchend",t[19]),d(k,"change",t[25]),d(k,"input",t[25]),d(k,"mousedown",t[11]),d(k,"touchstart",t[11],{passive:!0}),d(k,"input",t[12]),d(k,"change",t[13])],P=!0)},p(t,e){(!H||1&e[0])&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(s,t[0]),(!H||4&e[0])&&p(x,"width",t[2]),(!H||8&e[0])&&p(x,"height",t[3]),1024&e[0]&&m(k,t[10]);const n={};!L&&4&e[0]&&(L=!0,n.width=t[2],M((()=>L=!1))),!j&&8&e[0]&&(j=!0,n.height=t[3],M((()=>j=!1))),!z&&16&e[0]&&(z=!0,n.offset=t[4],M((()=>z=!1))),!E&&2&e[0]&&(E=!0,n.zoom=t[1],M((()=>E=!1))),!q&&32&e[0]&&(q=!0,n.color=t[5],M((()=>q=!1))),!I&&128&e[0]&&(I=!0,n.numberOfThreads=t[7],M((()=>I=!1))),!V&&64&e[0]&&(V=!0,n.numberOfIterations=t[6],M((()=>V=!1))),C.$set(n),t[9]?st?(st.p(t,e),512&e[0]&&N(st,1)):(st=et(),st.c(),N(st,1),st.m(Y.parentNode,Y)):st&&(T={r:0,c:[],p:T},B(st,1,1,(()=>{st=null})),T.r||o(T.c),T=T.p)},i(t){H||(N(g.$$.fragment,t),N(C.$$.fragment,t),N(st),H=!0)},o(t){B(g.$$.fragment,t),B(C.$$.fragment,t),B(st),H=!1},d(s){s&&u(e),s&&u(n),s&&u(i),s&&u(a),s&&u(v),W(g),s&&u($),s&&u(w),t[21](null),W(C),s&&u(X),st&&st.d(s),s&&u(Y),P=!1,o(R)}}}function ot(){localStorage.lightMode=!document.body.classList.contains("light"),localStorage.lightMode&&document.body.classList.toggle("light")}function it(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,s){function c(t){try{u(o.next(t))}catch(t){s(t)}}function l(t){try{u(o.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}u((o=o.apply(t,e||[])).next())}))};let i,s,c,l,u,r=300,a=300,h=new P(0,0),f=50,d=100,p=navigator.hardwareConcurrency||1,m=!1,{version:g}=e,$=0;let y,x,_=!1,k=new Image;function O(t){_=!0,y=t,k.src=c.toDataURL(),x=h.copy()}function C(t){if(_){const e=new P(t.x-y.x,t.y-y.y);l.clearRect(0,0,r,a),l.drawImage(k,e.x,e.y),n(4,h.x=x.x-e.x/r/i,h),n(4,h.y=x.y+e.y/a/i,h)}}function L(t){return o(this,void 0,void 0,(function*(){t&&C(t),_=!1,yield M()}))}function M(){return o(this,void 0,void 0,(function*(){n(9,m=!0);const t=yield async function(t,e,n,o,i,s,c){await H.changeNumberOfThreads(c);let l=[];for(let u=0;u<H.all.length;u++)l.push(H.all[u].command("generate",[t,e,n,o.x,o.y,i,s,c,u]));const u=await Promise.all(l),r=new Uint8ClampedArray(t*e*4);for(let t=0;t<u.length;t++)console.log(u[t].length),r.set(u[t],u[0].length*t);return r}(r,a,i,h,s,d,p),e=new ImageData(t,r);l.putImageData(e,0,0),n(9,m=!1)}))}var j;j=()=>o(void 0,void 0,void 0,(function*(){"true"===localStorage.lightMode&&document.body.classList.add("light"),setTimeout((()=>document.body.classList.add("loaded")),500),l=c.getContext("2d"),yield M()})),w().$$.on_mount.push(j);return t.$$set=t=>{"version"in t&&n(0,g=t.version)},t.$$.update=()=>{2&t.$$.dirty[0]&&(i=f/100)},[g,f,r,a,h,s,d,p,c,m,$,function(){u=f,k.src=c.toDataURL()},function(){const t=Math.pow(2,$);n(1,f=Number((t*u).toFixed(1))),l.clearRect(0,0,r,a),l.drawImage(k,(r-r*t)/2,(a-a*t)/2,r*t,a*t)},function(){return o(this,void 0,void 0,(function*(){n(10,$=0),yield M()}))},O,C,L,function(t){t.preventDefault(),O(new P(t.touches[0].clientX,t.touches[0].clientY))},function(t){t.preventDefault(),C(new P(t.touches[0].clientX,t.touches[0].clientY))},function(t){return o(this,void 0,void 0,(function*(){t.preventDefault(),yield L()}))},M,function(t){b[t?"unshift":"push"]((()=>{c=t,n(8,c)}))},t=>O(new P(t.offsetX,t.offsetY)),t=>C(new P(t.offsetX,t.offsetY)),t=>L(new P(t.offsetX,t.offsetY)),function(){$=v(this.value),n(10,$)},function(t){r=t,n(2,r)},function(t){a=t,n(3,a)},function(t){h=t,n(4,h)},function(t){f=t,n(1,f)},function(t){s=t,n(5,s)},function(t){p=t,n(7,p)},function(t){d=t,n(6,d)}]}return new class extends Y{constructor(t){super(),X(this,t,it,nt,s,{version:0},[-1,-1])}}({target:document.body,props:{version:"v1.2.0"}})}();
//# sourceMappingURL=bundle.js.map
